<%- include('partials/head') %>

<body>
    <div class="screen-overlay"></div>
    <%- include('partials/aside') %>
    <main class="main-wrap">
        <%- include('partials/header') %> 
        <section class="content-main">
            <div class="content-header">
                <div>
                    <h2 class="content-title card-title">Dashboard </h2>
                    <p>Whole data about your business here</p>
                </div>
                <div>
                    <a href="/admin/salesReport" class="btn btn-primary"><i class="text-muted material-icons md-post_add"></i>Create report</a>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-4">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-primary-light"><i class="text-primary material-icons md-monetization_on"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Revenue</h6>
                                <span>&#8377;  <%= totalRevenue[0].totalAmount  %></span>
                                <span class="text-sm">
                                    Shipping fees not included
                                </span>
                            </div>
                        </article>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-primary-light"><i class="text-primary material-icons md-monetization_on"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Total Refund</h6> <span><%= totalRefund[0].totalAmount %></span>
                                <span class="text-sm">
                                  In <%= new Date().getFullYear();  %>
                                </span>
                            </div>
                        </article>
                    </div>
                </div>
                <div class="col-lg-4">
                <div class="card card-body mb-4">
                    <article class="icontext">
                        <span class="icon icon-sm rounded-circle bg-primary-light"><i class="text-primary material-icons md-monetization_on"></i></span>
                        <div class="text">
                            <h6 class="mb-1 card-title">Net Revenue</h6>
                            <span>&#8377;  <%= revenueGenerated %></span>
                            <span class="text-sm">
                                Shipping fees not included
                            </span>
                        </div>
                    </article>
                </div>
                </div>
                <div class="col-lg-4">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-success-light"><i class="text-success material-icons md-local_shipping"></i></span>
                            <div class="text">
                             
                                <h6 class="mb-1 card-title">Orders</h6> <span><%= orderData  %></span>
                           
                                <span class="text-sm">
                                    Excluding orders in transit
                                </span>
                            </div>
                        </article>
                    </div>
                </div>
               
                <div class="col-lg-4">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-warning-light"><i class="text-warning material-icons md-qr_code"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Products</h6> <span><%= totalProductsSold[0].totalProducts  %></span>
                                <span class="text-sm">
                                    In <%= categories%> Categories
                                </span>
                            </div>
                        </article>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-info-light"><i class="text-info material-icons md-shopping_basket"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Monthly Earning</h6>
                                <% const today = new Date(); %>
                            
                                <% let month = today.getMonth() + 1; %>
                                <% let targetMonthData = monthlyEarnings.find(item => item._id === month); %>
                            
                                <% if (targetMonthData) { %>
                                    <span>&#8377; <%= targetMonthData.netEarnings %></span>
                                    <input type="text" id="monthnumber" value="<%= targetMonthData._id %>" hidden>
                                    <span id="monthfield" class="text-sm"></span>
                                <% } else { %>
                                    <span>No data available for this month</span>
                                <% } %>
                            </div>
                            
                        </article>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-8 col-lg-12" style="display: none;" id="chartContent">
                    <div class="card mb-4">
                        <article class="card-body">
                            <h5 class="card-title">Sale statistics</h5>
                            <canvas id="myChart" height="120px"></canvas>
                        </article>
                    </div>
                    <div class="row">
                       
                    </div>
                </div>
                <div id="chartContent2" style="display: none;" class="col-xl-4 col-lg-12">
                    <div  class="card mb-4" >
                        <article class="card-body">
                            <h5 class="card-title">Category Based Sales</h5>
                            <canvas id="myChart2" height="217"></canvas>
                        </article>
                    </div>
                   
                </div>
            </div>
          
                    </div>
                </header>
                <div class="card-body">
                    <div class="table-responsive">
                        <div class="table-responsive">
                            <table class="table align-middle table-nowrap mb-0">
                                <thead class="table-light">
                                    <tr>
                                       
                                        <th class="align-middle" scope="col">Order ID</th>
                                        <th class="align-middle" scope="col">Billing Name</th>
                                        <th class="align-middle" scope="col">Date</th>
                                        <th class="align-middle" scope="col">Total</th>
                                        <th class="align-middle" scope="col">Order Status</th>
                                        <th class="align-middle" scope="col">Payment Status</th>
                                        <th class="align-middle" scope="col">Payment Method</th>
                                        <th class="align-middle" scope="col">View Details</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% if(orders && orders.length > 0){ %>
                                        <% for(let i=0; i<orders.length; i++){ %>
                                    <tr>
                            
                                        <td><a href="#" class="fw-bold"><%= orders[i].orderId  %></a> </td>
                                        <td><%= orders[i].address.name  %></td>
                                        <td>
                                           <%= ((orders[i].orderDate).toString()).slice(0,16)  %>
                                        </td>
                                        <td>
                                           <%= orders[i].totalAmount  %>
                                        </td>
                                     

                                            <%if(orders[i].orderStatus === 'Modified' ){ %>
                                              <td>  Order Cancelled / Returned </td>
                                                <% } else { %>
                                                    <td><%= orders[i].orderStatus  %></td>
                                                    <% } %>
                                      
                                        <td>
                                            <% if(orders[i].paymentStatus === 'Pending') {%>
                                            <span class="badge badge-pill badge-soft-warning" style="color: black;">Pending</span>
                                            <% } else if(orders[i].refundAmount !== 0) { %>
                                                <span class="badge badge-pill badge-soft-danger" style="color: black;">Refunded</span>
                                              
                                            <% }else { %>
                                                <span class="badge badge-pill badge-soft-success" style="color: black;">Paid</span>
                                                <% } %>
                                        </td>
                                        <td>
                                            <i class="material-icons md-payment text-muted mr-5"></i><p> <%= orders[i].paymentMethod  %></p>
                                        </td>
                                        <td>
                                            <a href="/admin/viewOrderDetails?orderId=<%= orders[i].orderId  %>" class="btn btn-xs"> View details</a>
                                        </td>
                                    </tr>
                                    <% } %>
<% } %>                                  
                                </tbody>
                            </table>
                        </div>
                    </div> 
                </div>
            </div>
            <div class="pagination-area mt-30 mb-50">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-start">
                        <% for(let i=1; i<= totalPages; i++) {  %>
                        <li class="page-item <%= currentPage === i ? 'active' : '' %>"><a class="page-link" href="/admin/home?page=<%=i%>"><%= i  %></a></li>
<% } %>
                    </ul>
                </nav>
            </div>
        </section> <!-- content-main end// -->
     
    </main>
    <%- include('partials/script') %>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="/admin/helpers/home.js">
     

        </script>

 




</body>


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:32:57 GMT -->
</html>